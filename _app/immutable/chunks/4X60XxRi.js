import{c as L,e as p,a as I,t as q,s as Lt}from"./D7QwtGmi.js";import{i as Wt}from"./Cfds0igE.js";import{p as Rt,f as T,t as J,b as Bt,ad as $t,l as $,a as te,g as x,s as tt,c as et,r as nt,m as xt,e as k,d as pt,ae as wt}from"./nmJ6A6bS.js";import{l as rt,p as S,i as A,s as Z,b as Tt}from"./B0bZb3nm.js";import{b as _,a as ct,t as M,d as ee,s as H}from"./CnmEZeeQ.js";import{c as Et}from"./D-OODaHY.js";import{a as ne}from"./CoAGfW2e.js";import{b as Jt}from"./DlW3wmKb.js";import{f as se}from"./BwWVMVpJ.js";var ie=q("<a></a>"),oe=q("<div></div>");function re(o,t){const e=rt(t,["children","$$slots","$$events","$$legacy"]),n=rt(e,["href","size"]);Rt(t,!1);let s=S(t,"href",8,void 0),i=S(t,"size",8,"default");Wt();var c=L(),a=T(c);A(a,s,l=>{var r=ie();let u;r.textContent="",J(()=>{u=ct(r,u,{href:s(),rel:n.target==="_blank"?"noopener noreferrer":void 0,role:"button",...n}),M(r,"bx--skeleton",!0),M(r,"bx--btn",!0),M(r,"bx--btn--field",i()==="field"),M(r,"bx--btn--sm",i()==="small"),M(r,"bx--btn--lg",i()==="lg"),M(r,"bx--btn--xl",i()==="xl")}),p("click",r,function(d){_.call(this,t,d)}),p("focus",r,function(d){_.call(this,t,d)}),p("blur",r,function(d){_.call(this,t,d)}),p("mouseover",r,function(d){_.call(this,t,d)}),p("mouseenter",r,function(d){_.call(this,t,d)}),p("mouseleave",r,function(d){_.call(this,t,d)}),I(l,r)},l=>{var r=oe();let u;J(()=>{u=ct(r,u,{...n}),M(r,"bx--skeleton",!0),M(r,"bx--btn",!0),M(r,"bx--btn--field",i()==="field"),M(r,"bx--btn--sm",i()==="small"),M(r,"bx--btn--lg",i()==="lg"),M(r,"bx--btn--xl",i()==="xl")}),p("click",r,function(d){_.call(this,t,d)}),p("focus",r,function(d){_.call(this,t,d)}),p("blur",r,function(d){_.call(this,t,d)}),p("mouseover",r,function(d){_.call(this,t,d)}),p("mouseenter",r,function(d){_.call(this,t,d)}),p("mouseleave",r,function(d){_.call(this,t,d)}),I(l,r)}),I(o,c),Bt()}var ce=q("<span> </span>"),ae=q("<a><!> <!> <!></a>"),le=q("<span> </span>"),ue=q("<button><!> <!> <!></button>");function Le(o,t){const e=ee(t),n=rt(t,["children","$$slots","$$events","$$legacy"]),s=rt(n,["kind","size","expressive","isSelected","icon","iconDescription","tooltipAlignment","tooltipPosition","as","skeleton","disabled","href","tabindex","type","ref"]);Rt(t,!1);const i=xt(),c=xt(),a=xt();let l=S(t,"kind",8,"primary"),r=S(t,"size",8,"default"),u=S(t,"expressive",8,!1),d=S(t,"isSelected",8,!1),h=S(t,"icon",8,void 0),g=S(t,"iconDescription",8,void 0),b=S(t,"tooltipAlignment",8,"center"),f=S(t,"tooltipPosition",8,"bottom"),v=S(t,"as",8,!1),j=S(t,"skeleton",8,!1),z=S(t,"disabled",8,!1),E=S(t,"href",8,void 0),R=S(t,"tabindex",8,"0"),P=S(t,"type",8,"button"),F=S(t,"ref",12,null);const D=$t("ComposedModal");$(()=>k(F()),()=>{D&&F()&&D.declareRef(F())}),$(()=>k(h()),()=>{pt(i,(h()||e.icon)&&!e.default)}),$(()=>k(g()),()=>{pt(c,{"aria-hidden":"true",class:"bx--btn__icon","aria-label":g()})}),$(()=>(k(E()),k(z()),k(P()),k(R()),x(i),k(l()),k(d()),k(s),k(u()),k(r()),k(f()),k(b())),()=>{pt(a,{type:E()&&!z()?void 0:P(),tabindex:R(),disabled:z()===!0?!0:void 0,href:E(),"aria-pressed":x(i)&&l()==="ghost"&&!E()?d():void 0,...s,class:["bx--btn",u()&&"bx--btn--expressive",(r()==="small"&&!u()||r()==="sm"&&!u()||r()==="small"&&!u())&&"bx--btn--sm",r()==="field"&&!u()||r()==="md"&&!u()&&"bx--btn--md",r()==="field"&&"bx--btn--field",r()==="small"&&"bx--btn--sm",r()==="lg"&&"bx--btn--lg",r()==="xl"&&"bx--btn--xl",l()&&`bx--btn--${l()}`,z()&&"bx--btn--disabled",x(i)&&"bx--btn--icon-only",x(i)&&"bx--tooltip__trigger",x(i)&&"bx--tooltip--a11y",x(i)&&f()&&`bx--btn--icon-only--${f()}`,x(i)&&b()&&`bx--tooltip--align-${b()}`,x(i)&&d()&&l()==="ghost"&&"bx--btn--selected",s.class].filter(Boolean).join(" ")})}),te(),Wt();var Vt=L(),Xt=T(Vt);A(Xt,j,lt=>{var X=wt(()=>x(i)&&"width: 3rem;");re(lt,Z({get href(){return E()},get size(){return r()}},()=>s,{get style(){return x(X)},$$events:{click(C){_.call(this,t,C)},focus(C){_.call(this,t,C)},blur(C){_.call(this,t,C)},mouseover(C){_.call(this,t,C)},mouseenter(C){_.call(this,t,C)},mouseleave(C){_.call(this,t,C)}}}))},lt=>{var X=L(),C=T(X);A(C,v,ut=>{var Q=L(),dt=T(Q);H(dt,t,"default",{get props(){return x(a)}},null),I(ut,Q)},ut=>{var Q=L(),dt=T(Q);A(dt,()=>E()&&!z(),ht=>{var w=ae();let U;var K=et(w);A(K,()=>x(i),m=>{var y=ce();M(y,"bx--assistive-text",!0);var V=et(y,!0);nt(y),J(()=>Lt(V,g())),I(m,y)});var G=tt(K,2);H(G,t,"default",{},null);var ft=tt(G,2);A(ft,()=>e.icon,m=>{var y=L(),V=T(y);H(V,t,"icon",Z({get style(){return x(i)?"margin-left: 0":void 0}},()=>x(c)),null),I(m,y)},m=>{var y=L(),V=T(y);A(V,h,mt=>{var Y=L(),gt=T(Y),_t=wt(()=>x(i)?"margin-left: 0":void 0);Et(gt,h,(bt,vt)=>{vt(bt,Z({get style(){return x(_t)}},()=>x(c)))}),I(mt,Y)},null,!0),I(m,y)}),nt(w),Tt(w,m=>F(m),()=>F()),J(()=>U=ct(w,U,{...x(a)})),p("click",w,function(m){_.call(this,t,m)}),p("focus",w,function(m){_.call(this,t,m)}),p("blur",w,function(m){_.call(this,t,m)}),p("mouseover",w,function(m){_.call(this,t,m)}),p("mouseenter",w,function(m){_.call(this,t,m)}),p("mouseleave",w,function(m){_.call(this,t,m)}),I(ht,w)},ht=>{var w=ue();let U;var K=et(w);A(K,()=>x(i),m=>{var y=le();M(y,"bx--assistive-text",!0);var V=et(y,!0);nt(y),J(()=>Lt(V,g())),I(m,y)});var G=tt(K,2);H(G,t,"default",{},null);var ft=tt(G,2);A(ft,()=>e.icon,m=>{var y=L(),V=T(y);H(V,t,"icon",Z({get style(){return x(i)?"margin-left: 0":void 0}},()=>x(c)),null),I(m,y)},m=>{var y=L(),V=T(y);A(V,h,mt=>{var Y=L(),gt=T(Y),_t=wt(()=>x(i)?"margin-left: 0":void 0);Et(gt,h,(bt,vt)=>{vt(bt,Z({get style(){return x(_t)}},()=>x(c)))}),I(mt,Y)},null,!0),I(m,y)}),nt(w),Tt(w,m=>F(m),()=>F()),J(()=>U=ct(w,U,{...x(a)})),p("click",w,function(m){_.call(this,t,m)}),p("focus",w,function(m){_.call(this,t,m)}),p("blur",w,function(m){_.call(this,t,m)}),p("mouseover",w,function(m){_.call(this,t,m)}),p("mouseenter",w,function(m){_.call(this,t,m)}),p("mouseleave",w,function(m){_.call(this,t,m)}),I(ht,w)},!0),I(ut,Q)},!0),I(lt,X)}),I(o,Vt),Bt()}function ot(o,t,e,n){function s(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function a(u){try{r(n.next(u))}catch(d){c(d)}}function l(u){try{r(n.throw(u))}catch(d){c(d)}}function r(u){u.done?i(u.value):s(u.value).then(a,l)}r((n=n.apply(o,[])).next())})}const de="ENTRIES",qt="KEYS",Qt="VALUES",O="";class yt{constructor(t,e){const n=t._tree,s=Array.from(n.keys());this.set=t,this._type=e,this._path=s.length>0?[{node:n,keys:s}]:[]}next(){const t=this.dive();return this.backtrack(),t}dive(){if(this._path.length===0)return{done:!0,value:void 0};const{node:t,keys:e}=B(this._path);if(B(e)===O)return{done:!1,value:this.result()};const n=t.get(B(e));return this._path.push({node:n,keys:Array.from(n.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;const t=B(this._path).keys;t.pop(),!(t.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:t})=>B(t)).filter(t=>t!==O).join("")}value(){return B(this._path).node.get(O)}result(){switch(this._type){case Qt:return this.value();case qt:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}}const B=o=>o[o.length-1],he=(o,t,e)=>{const n=new Map;if(t===void 0)return n;const s=t.length+1,i=s+e,c=new Uint8Array(i*s).fill(e+1);for(let a=0;a<s;++a)c[a]=a;for(let a=1;a<i;++a)c[a*s]=a;return Ut(o,t,e,n,c,1,s,""),n},Ut=(o,t,e,n,s,i,c,a)=>{const l=i*c;t:for(const r of o.keys())if(r===O){const u=s[l-1];u<=e&&n.set(a,[o.get(r),u])}else{let u=i;for(let d=0;d<r.length;++d,++u){const h=r[d],g=c*u,b=g-c;let f=s[g];const v=Math.max(0,u-e-1),j=Math.min(c-1,u+e);for(let z=v;z<j;++z){const E=h!==t[z],R=s[b+z]+ +E,P=s[b+z+1]+1,F=s[g+z]+1,D=s[g+z+1]=Math.min(R,P,F);D<f&&(f=D)}if(f>e)continue t}Ut(o.get(r),t,e,n,s,u,c,a+r)}};class N{constructor(t=new Map,e=""){this._size=void 0,this._tree=t,this._prefix=e}atPrefix(t){if(!t.startsWith(this._prefix))throw new Error("Mismatched prefix");const[e,n]=at(this._tree,t.slice(this._prefix.length));if(e===void 0){const[s,i]=Ct(n);for(const c of s.keys())if(c!==O&&c.startsWith(i)){const a=new Map;return a.set(c.slice(i.length),s.get(c)),new N(a,t)}}return new N(e,t)}clear(){this._size=void 0,this._tree.clear()}delete(t){return this._size=void 0,fe(this._tree,t)}entries(){return new yt(this,de)}forEach(t){for(const[e,n]of this)t(e,n,this)}fuzzyGet(t,e){return he(this._tree,t,e)}get(t){const e=Ft(this._tree,t);return e!==void 0?e.get(O):void 0}has(t){const e=Ft(this._tree,t);return e!==void 0&&e.has(O)}keys(){return new yt(this,qt)}set(t,e){if(typeof t!="string")throw new Error("key must be a string");return this._size=void 0,zt(this._tree,t).set(O,e),this}get size(){if(this._size)return this._size;this._size=0;const t=this.entries();for(;!t.next().done;)this._size+=1;return this._size}update(t,e){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const n=zt(this._tree,t);return n.set(O,e(n.get(O))),this}fetch(t,e){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const n=zt(this._tree,t);let s=n.get(O);return s===void 0&&n.set(O,s=e()),s}values(){return new yt(this,Qt)}[Symbol.iterator](){return this.entries()}static from(t){const e=new N;for(const[n,s]of t)e.set(n,s);return e}static fromObject(t){return N.from(Object.entries(t))}}const at=(o,t,e=[])=>{if(t.length===0||o==null)return[o,e];for(const n of o.keys())if(n!==O&&t.startsWith(n))return e.push([o,n]),at(o.get(n),t.slice(n.length),e);return e.push([o,t]),at(void 0,"",e)},Ft=(o,t)=>{if(t.length===0||o==null)return o;for(const e of o.keys())if(e!==O&&t.startsWith(e))return Ft(o.get(e),t.slice(e.length))},zt=(o,t)=>{const e=t.length;t:for(let n=0;o&&n<e;){for(const i of o.keys())if(i!==O&&t[n]===i[0]){const c=Math.min(e-n,i.length);let a=1;for(;a<c&&t[n+a]===i[a];)++a;const l=o.get(i);if(a===i.length)o=l;else{const r=new Map;r.set(i.slice(a),l),o.set(t.slice(n,n+a),r),o.delete(i),o=r}n+=a;continue t}const s=new Map;return o.set(t.slice(n),s),s}return o},fe=(o,t)=>{const[e,n]=at(o,t);if(e!==void 0){if(e.delete(O),e.size===0)Kt(n);else if(e.size===1){const[s,i]=e.entries().next().value;Gt(n,s,i)}}},Kt=o=>{if(o.length===0)return;const[t,e]=Ct(o);if(t.delete(e),t.size===0)Kt(o.slice(0,-1));else if(t.size===1){const[n,s]=t.entries().next().value;n!==O&&Gt(o.slice(0,-1),n,s)}},Gt=(o,t,e)=>{if(o.length===0)return;const[n,s]=Ct(o);n.set(s+t,e),n.delete(s)},Ct=o=>o[o.length-1],jt="or",Yt="and",me="and_not";class W{constructor(t){if((t==null?void 0:t.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');const e=t.autoVacuum==null||t.autoVacuum===!0?Ot:t.autoVacuum;this._options=Object.assign(Object.assign(Object.assign({},It),t),{autoVacuum:e,searchOptions:Object.assign(Object.assign({},At),t.searchOptions||{}),autoSuggestOptions:Object.assign(Object.assign({},xe),t.autoSuggestOptions||{})}),this._index=new N,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Mt,this.addFields(this._options.fields)}add(t){const{extractField:e,tokenize:n,processTerm:s,fields:i,idField:c}=this._options,a=e(t,c);if(a==null)throw new Error(`MiniSearch: document does not have ID field "${c}"`);if(this._idToShortId.has(a))throw new Error(`MiniSearch: duplicate ID ${a}`);const l=this.addDocumentId(a);this.saveStoredFields(l,t);for(const r of i){const u=e(t,r);if(u==null)continue;const d=n(u.toString(),r),h=this._fieldIds[r],g=new Set(d).size;this.addFieldLength(l,h,this._documentCount-1,g);for(const b of d){const f=s(b,r);if(Array.isArray(f))for(const v of f)this.addTerm(h,l,v);else f&&this.addTerm(h,l,f)}}}addAll(t){for(const e of t)this.add(e)}addAllAsync(t,e={}){const{chunkSize:n=10}=e,s={chunk:[],promise:Promise.resolve()},{chunk:i,promise:c}=t.reduce(({chunk:a,promise:l},r,u)=>(a.push(r),(u+1)%n===0?{chunk:[],promise:l.then(()=>new Promise(d=>setTimeout(d,0))).then(()=>this.addAll(a))}:{chunk:a,promise:l}),s);return c.then(()=>this.addAll(i))}remove(t){const{tokenize:e,processTerm:n,extractField:s,fields:i,idField:c}=this._options,a=s(t,c);if(a==null)throw new Error(`MiniSearch: document does not have ID field "${c}"`);const l=this._idToShortId.get(a);if(l==null)throw new Error(`MiniSearch: cannot remove document with ID ${a}: it is not in the index`);for(const r of i){const u=s(t,r);if(u==null)continue;const d=e(u.toString(),r),h=this._fieldIds[r],g=new Set(d).size;this.removeFieldLength(l,h,this._documentCount,g);for(const b of d){const f=n(b,r);if(Array.isArray(f))for(const v of f)this.removeTerm(h,l,v);else f&&this.removeTerm(h,l,f)}}this._storedFields.delete(l),this._documentIds.delete(l),this._idToShortId.delete(a),this._fieldLength.delete(l),this._documentCount-=1}removeAll(t){if(t)for(const e of t)this.remove(e);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new N,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(t){const e=this._idToShortId.get(t);if(e==null)throw new Error(`MiniSearch: cannot discard document with ID ${t}: it is not in the index`);this._idToShortId.delete(t),this._documentIds.delete(e),this._storedFields.delete(e),(this._fieldLength.get(e)||[]).forEach((n,s)=>{this.removeFieldLength(e,s,this._documentCount,n)}),this._fieldLength.delete(e),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;const{minDirtFactor:t,minDirtCount:e,batchSize:n,batchWait:s}=this._options.autoVacuum;this.conditionalVacuum({batchSize:n,batchWait:s},{minDirtCount:e,minDirtFactor:t})}discardAll(t){const e=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(const n of t)this.discard(n)}finally{this._options.autoVacuum=e}this.maybeAutoVacuum()}replace(t){const{idField:e,extractField:n}=this._options,s=n(t,e);this.discard(s),this.add(t)}vacuum(t={}){return this.conditionalVacuum(t)}conditionalVacuum(t,e){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&e,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{const n=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=Mt,this.performVacuuming(t,n)}),this._enqueuedVacuum)):this.vacuumConditionsMet(e)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(t),this._currentVacuum)}performVacuuming(t,e){return ot(this,void 0,void 0,function*(){const n=this._dirtCount;if(this.vacuumConditionsMet(e)){const s=t.batchSize||kt.batchSize,i=t.batchWait||kt.batchWait;let c=1;for(const[a,l]of this._index){for(const[r,u]of l)for(const[d]of u)this._documentIds.has(d)||(u.size<=1?l.delete(r):u.delete(d));this._index.get(a).size===0&&this._index.delete(a),c%s===0&&(yield new Promise(r=>setTimeout(r,i))),c+=1}this._dirtCount-=n}yield null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null})}vacuumConditionsMet(t){if(t==null)return!0;let{minDirtCount:e,minDirtFactor:n}=t;return e=e||Ot.minDirtCount,n=n||Ot.minDirtFactor,this.dirtCount>=e&&this.dirtFactor>=n}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(t){return this._idToShortId.has(t)}getStoredFields(t){const e=this._idToShortId.get(t);if(e!=null)return this._storedFields.get(e)}search(t,e={}){const{searchOptions:n}=this._options,s=Object.assign(Object.assign({},n),e),i=this.executeQuery(t,e),c=[];for(const[a,{score:l,terms:r,match:u}]of i){const d=r.length||1,h={id:this._documentIds.get(a),score:l*d,terms:Object.keys(u),queryTerms:r,match:u};Object.assign(h,this._storedFields.get(a)),(s.filter==null||s.filter(h))&&c.push(h)}return t===W.wildcard&&s.boostDocument==null||c.sort(Nt),c}autoSuggest(t,e={}){e=Object.assign(Object.assign({},this._options.autoSuggestOptions),e);const n=new Map;for(const{score:i,terms:c}of this.search(t,e)){const a=c.join(" "),l=n.get(a);l!=null?(l.score+=i,l.count+=1):n.set(a,{score:i,terms:c,count:1})}const s=[];for(const[i,{score:c,terms:a,count:l}]of n)s.push({suggestion:i,terms:a,score:c/l});return s.sort(Nt),s}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(t,e){if(e==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(t),e)}static loadJSONAsync(t,e){return ot(this,void 0,void 0,function*(){if(e==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(t),e)})}static getDefault(t){if(It.hasOwnProperty(t))return St(It,t);throw new Error(`MiniSearch: unknown option "${t}"`)}static loadJS(t,e){const{index:n,documentIds:s,fieldLength:i,storedFields:c,serializationVersion:a}=t,l=this.instantiateMiniSearch(t,e);l._documentIds=st(s),l._fieldLength=st(i),l._storedFields=st(c);for(const[r,u]of l._documentIds)l._idToShortId.set(u,r);for(const[r,u]of n){const d=new Map;for(const h of Object.keys(u)){let g=u[h];a===1&&(g=g.ds),d.set(parseInt(h,10),st(g))}l._index.set(r,d)}return l}static loadJSAsync(t,e){return ot(this,void 0,void 0,function*(){const{index:n,documentIds:s,fieldLength:i,storedFields:c,serializationVersion:a}=t,l=this.instantiateMiniSearch(t,e);l._documentIds=yield it(s),l._fieldLength=yield it(i),l._storedFields=yield it(c);for(const[u,d]of l._documentIds)l._idToShortId.set(d,u);let r=0;for(const[u,d]of n){const h=new Map;for(const g of Object.keys(d)){let b=d[g];a===1&&(b=b.ds),h.set(parseInt(g,10),yield it(b))}++r%1e3===0&&(yield Zt(0)),l._index.set(u,h)}return l})}static instantiateMiniSearch(t,e){const{documentCount:n,nextId:s,fieldIds:i,averageFieldLength:c,dirtCount:a,serializationVersion:l}=t;if(l!==1&&l!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");const r=new W(e);return r._documentCount=n,r._nextId=s,r._idToShortId=new Map,r._fieldIds=i,r._avgFieldLength=c,r._dirtCount=a||0,r._index=new N,r}executeQuery(t,e={}){if(t===W.wildcard)return this.executeWildcardQuery(e);if(typeof t!="string"){const h=Object.assign(Object.assign(Object.assign({},e),t),{queries:void 0}),g=t.queries.map(b=>this.executeQuery(b,h));return this.combineResults(g,h.combineWith)}const{tokenize:n,processTerm:s,searchOptions:i}=this._options,c=Object.assign(Object.assign({tokenize:n,processTerm:s},i),e),{tokenize:a,processTerm:l}=c,d=a(t).flatMap(h=>l(h)).filter(h=>!!h).map(ve(c)).map(h=>this.executeQuerySpec(h,c));return this.combineResults(d,c.combineWith)}executeQuerySpec(t,e){const n=Object.assign(Object.assign({},this._options.searchOptions),e),s=(n.fields||this._options.fields).reduce((f,v)=>Object.assign(Object.assign({},f),{[v]:St(n.boost,v)||1}),{}),{boostDocument:i,weights:c,maxFuzzy:a,bm25:l}=n,{fuzzy:r,prefix:u}=Object.assign(Object.assign({},At.weights),c),d=this._index.get(t.term),h=this.termResults(t.term,t.term,1,t.termBoost,d,s,i,l);let g,b;if(t.prefix&&(g=this._index.atPrefix(t.term)),t.fuzzy){const f=t.fuzzy===!0?.2:t.fuzzy,v=f<1?Math.min(a,Math.round(t.term.length*f)):f;v&&(b=this._index.fuzzyGet(t.term,v))}if(g)for(const[f,v]of g){const j=f.length-t.term.length;if(!j)continue;b==null||b.delete(f);const z=u*f.length/(f.length+.3*j);this.termResults(t.term,f,z,t.termBoost,v,s,i,l,h)}if(b)for(const f of b.keys()){const[v,j]=b.get(f);if(!j)continue;const z=r*f.length/(f.length+j);this.termResults(t.term,f,z,t.termBoost,v,s,i,l,h)}return h}executeWildcardQuery(t){const e=new Map,n=Object.assign(Object.assign({},this._options.searchOptions),t);for(const[s,i]of this._documentIds){const c=n.boostDocument?n.boostDocument(i,"",this._storedFields.get(s)):1;e.set(s,{score:c,terms:[],match:{}})}return e}combineResults(t,e=jt){if(t.length===0)return new Map;const n=e.toLowerCase(),s=ge[n];if(!s)throw new Error(`Invalid combination operator: ${e}`);return t.reduce(s)||new Map}toJSON(){const t=[];for(const[e,n]of this._index){const s={};for(const[i,c]of n)s[i]=Object.fromEntries(c);t.push([e,s])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:t,serializationVersion:2}}termResults(t,e,n,s,i,c,a,l,r=new Map){if(i==null)return r;for(const u of Object.keys(c)){const d=c[u],h=this._fieldIds[u],g=i.get(h);if(g==null)continue;let b=g.size;const f=this._avgFieldLength[h];for(const v of g.keys()){if(!this._documentIds.has(v)){this.removeTerm(h,v,e),b-=1;continue}const j=a?a(this._documentIds.get(v),e,this._storedFields.get(v)):1;if(!j)continue;const z=g.get(v),E=this._fieldLength.get(v)[h],R=be(z,b,this._documentCount,E,f,l),P=n*s*d*j*R,F=r.get(v);if(F){F.score+=P,pe(F.terms,t);const D=St(F.match,e);D?D.push(u):F.match[e]=[u]}else r.set(v,{score:P,terms:[t],match:{[e]:[u]}})}}return r}addTerm(t,e,n){const s=this._index.fetch(n,Pt);let i=s.get(t);if(i==null)i=new Map,i.set(e,1),s.set(t,i);else{const c=i.get(e);i.set(e,(c||0)+1)}}removeTerm(t,e,n){if(!this._index.has(n)){this.warnDocumentChanged(e,t,n);return}const s=this._index.fetch(n,Pt),i=s.get(t);i==null||i.get(e)==null?this.warnDocumentChanged(e,t,n):i.get(e)<=1?i.size<=1?s.delete(t):i.delete(e):i.set(e,i.get(e)-1),this._index.get(n).size===0&&this._index.delete(n)}warnDocumentChanged(t,e,n){for(const s of Object.keys(this._fieldIds))if(this._fieldIds[s]===e){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(t)} has changed before removal: term "${n}" was not present in field "${s}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(t){const e=this._nextId;return this._idToShortId.set(t,e),this._documentIds.set(e,t),this._documentCount+=1,this._nextId+=1,e}addFields(t){for(let e=0;e<t.length;e++)this._fieldIds[t[e]]=e}addFieldLength(t,e,n,s){let i=this._fieldLength.get(t);i==null&&this._fieldLength.set(t,i=[]),i[e]=s;const a=(this._avgFieldLength[e]||0)*n+s;this._avgFieldLength[e]=a/(n+1)}removeFieldLength(t,e,n,s){if(n===1){this._avgFieldLength[e]=0;return}const i=this._avgFieldLength[e]*n-s;this._avgFieldLength[e]=i/(n-1)}saveStoredFields(t,e){const{storeFields:n,extractField:s}=this._options;if(n==null||n.length===0)return;let i=this._storedFields.get(t);i==null&&this._storedFields.set(t,i={});for(const c of n){const a=s(e,c);a!==void 0&&(i[c]=a)}}}W.wildcard=Symbol("*");const St=(o,t)=>Object.prototype.hasOwnProperty.call(o,t)?o[t]:void 0,ge={[jt]:(o,t)=>{for(const e of t.keys()){const n=o.get(e);if(n==null)o.set(e,t.get(e));else{const{score:s,terms:i,match:c}=t.get(e);n.score=n.score+s,n.match=Object.assign(n.match,c),Dt(n.terms,i)}}return o},[Yt]:(o,t)=>{const e=new Map;for(const n of t.keys()){const s=o.get(n);if(s==null)continue;const{score:i,terms:c,match:a}=t.get(n);Dt(s.terms,c),e.set(n,{score:s.score+i,terms:s.terms,match:Object.assign(s.match,a)})}return e},[me]:(o,t)=>{for(const e of t.keys())o.delete(e);return o}},_e={k:1.2,b:.7,d:.5},be=(o,t,e,n,s,i)=>{const{k:c,b:a,d:l}=i;return Math.log(1+(e-t+.5)/(t+.5))*(l+o*(c+1)/(o+c*(1-a+a*n/s)))},ve=o=>(t,e,n)=>{const s=typeof o.fuzzy=="function"?o.fuzzy(t,e,n):o.fuzzy||!1,i=typeof o.prefix=="function"?o.prefix(t,e,n):o.prefix===!0,c=typeof o.boostTerm=="function"?o.boostTerm(t,e,n):1;return{term:t,fuzzy:s,prefix:i,termBoost:c}},It={idField:"id",extractField:(o,t)=>o[t],tokenize:o=>o.split(we),processTerm:o=>o.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(o,t)=>{typeof(console==null?void 0:console[o])=="function"&&console[o](t)},autoVacuum:!0},At={combineWith:jt,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:_e},xe={combineWith:Yt,prefix:(o,t,e)=>t===e.length-1},kt={batchSize:1e3,batchWait:10},Mt={minDirtFactor:.1,minDirtCount:20},Ot=Object.assign(Object.assign({},kt),Mt),pe=(o,t)=>{o.includes(t)||o.push(t)},Dt=(o,t)=>{for(const e of t)o.includes(e)||o.push(e)},Nt=({score:o},{score:t})=>t-o,Pt=()=>new Map,st=o=>{const t=new Map;for(const e of Object.keys(o))t.set(parseInt(e,10),o[e]);return t},it=o=>ot(void 0,void 0,void 0,function*(){const t=new Map;let e=0;for(const n of Object.keys(o))t.set(parseInt(n,10),o[n]),++e%1e3===0&&(yield Zt(0));return t}),Zt=o=>new Promise(t=>setTimeout(t,o)),we=/[\n\r\p{Z}\p{P}]+/u;function Ht(o,t){return t.split(".").reduce((e,n)=>{const s=parseInt(n,10);return e&&e[isNaN(s)?n:s]},o)}function ye(o){return{fields:o,extractField:(t,e)=>Ht(t,e),storeFields:["id","anumber","page_index","full_text","fields"]}}function ze(o){return{fields:o,extractField:(t,e)=>e.split(".").reduce((n,s)=>{const i=parseInt(s,10);return n&&n[isNaN(i)?s:i]},t),storeFields:["id","fields","page_count"]}}async function Te(o,t){const e=Object.fromEntries([...t.entries()].filter(([l])=>l.startsWith("limit_"))),n=`${Jt}/api/index/${o}.json`,s=t.getAll("selectedFields").filter(l=>se[o].some(r=>r.id===l)),i=new W(o=="afile"?ze(s):ye(s)),c=t.get("query")||W.wildcard;return await fetch(n).then(l=>l.json()).then(l=>{i.addAll(l);let r={prefix:!0,combineWith:"AND"};return Object.keys(e).length>0&&(r.filter=u=>Object.entries(e).every(([h,g])=>{const b=h.replace("limit_","");let f=Ht(u,b);return typeof f=="string"&&(f=f.toLowerCase(),g=g.toLowerCase()),f===g})),i.search(c,r)}).catch(l=>console.error(l))}function Ee(o){o.preventDefault(),localStorage.setItem("formReferrer",window.location.href);const t=o.target.attributes.scope.value,e=new FormData(o.target),n={query:e.get("query")};e.forEach((i,c)=>{i!=="any"&&i!==""&&(n[c]=i)});const s=new URLSearchParams(n);ne(`${Jt}/results/${t}?${s.toString()}`)}export{Le as B,Ee as h,Te as s};
